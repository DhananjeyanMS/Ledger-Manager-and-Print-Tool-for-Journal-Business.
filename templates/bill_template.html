<!DOCTYPE html>
<html>
<head>
    <title>Print Ledger Bill</title>
<style>
    @media print {
        body {
            margin: 0;
            padding: 10mm;
            font-size: 12px;
        }

        .no-print {
            display: none;
        }

        @page {
            size: A4 portrait;
            margin: 0;
        }
    }

    body {
        font-family: Arial, sans-serif;
        width: 90%;
        margin: 0 auto;
        padding: 10px;
        font-size: 12px;
    }

    .header {
        text-align: center;
        font-weight: bold;
        font-size: 12px;
        margin-bottom: 5px;
    }

    .top-flex {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 8px;
    }

    .bill-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 12px;
        margin-top: 8px;
    }

    .bill-table th, .bill-table td {
        border: 1px solid black;
        padding: 4px;
        text-align: center;
    }

    .right-align {
        text-align: right;
    }

    .footer {
        margin-top: 10px;
        font-size: 12px;
    }

        .receipt-header {
            text-align: center;
            font-weight: bold;
            font-size: 16px;
        }

        .receipt-logo {
            width: 50px;
            height: 50px;
            object-fit: contain;
        }

        .receipt-row {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .receipt-top {    
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            text-align: center;
            margin-bottom: 10px;
                margin-left: auto;
    margin-right: auto;
    width: fit-content; /* or a fixed width like 600px */
            
        }

        .receipt-line {
            margin: 12px 0;
            font-size: 14px;
            
        }

        .receipt-footer {
            margin-top: 30px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }

        .receipt-box {
            border: 2px solid #000;
            padding: 5px 20px;
            font-weight: bold;
            font-size: 16px;
            display: inline-block;
        }

        .signature-block {
            text-align: right;
            font-weight: bold;
        }





</style>
</head>
<body onload="window.print()">

<div class="bill-box">
    
    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px;">
    <!-- Left: Title and Address -->
    <div style="text-align: left; width: 33%;">
        <div style="font-size: 18px; font-weight: bold;">MALLIGAI MAGAL</div>
        <div style="font-size: 11px;">
            New # 4, Old # 46, Taylors Estate 2nd Street,<br>
            Kodambakkam, Chennai - 600 024.<br>
            Phone : 044 - 2472 0565, 75501 83899
        </div>
    </div>

    <!-- Center: Logo -->
    <div style="width: 34%; text-align: center;">
        <img src="{{ url_for('static', filename='logo.jpg') }}" alt="Logo" style="height: 60px;">
        <div style="font-size: 14px; font-weight: bold;">BILL</div>
    <div>No : <strong>{{ ledger.id }}</strong></div>
    </div>

    <!-- Right: Recipient Details -->
    <div style="text-align: right; width: 33%;">
        <div style="font-size: 15px;"><strong>To:</strong> {{ agent.agent_Name }}</div>
        <div style="font-size: 15px;"><strong>Location:</strong>{{ agent.area }}</div>
        <div style="margin-top: 10px; font-size: 15px;"><strong>Month:</strong> {{ ledger.entry_date.strftime('%B %y') }}</div>
    </div>
</div>
    <div class="header">
        MALLIGAI MAGAL, A/c No.1155115000015986, Karur Vysya Bank, Kodambakkam branch, IFSC Code: KVBL0001155
    </div>


    <table class="bill-table">
        <thead>
        <tr>
            <th>S.No</th>
            <th>Particulars</th>
            <th>Rate</th>
            <th>Copies</th>
            <th>Discount</th>
            <th>Amount (Rs.)</th>
        </tr>
        </thead>
        <tbody>
        {% set items = [
            ('Malligai Magal', ledger.count_MM, 40),
            ('Nalla Saappadu', ledger.count_NS, 50),
            ('Valli Novel', ledger.count_Valli, 40),
            ('Vaani Novel', ledger.count_Vani, 40),
            ('Azhagi Novel', ledger.count_Azhagi, 40),
            ('Arasi Novel', ledger.count_Arasi, 40),
            ('Thriller Novel', ledger.count_Thriller, 40)
        ] %}
        
        {% for idx in range(1, items|length + 1) %}
            {% set name, count, rate = items[idx - 1] %}
            {% set amt = (count or 0) * rate %}
            {% set discount = amt * 0.25 %}
            {% set final_amt = amt - discount %}
            <tr>
                <td>{{ idx }}</td>
                <td>{{ name }}</td>
                <td>Rs.{{ rate }}/-</td>
                <td>{{ count or 0 }}</td>
                <td>25%</td>
                <td>{{ "%.2f"|format(final_amt) }}</td>
            </tr>
        {% endfor %}
        </tbody>        
        <tfoot>
            <tr>
                <td colspan="5" class="right-align"><strong>Total</strong></td>
                <td>{{ "%.2f"|format(ledger.bill_Amount) }}</td>
            </tr>
            <tr>
                <td colspan="5" class="right-align"><strong>Old Balance</strong></td>
                <td>{{ "%.2f"|format(ledger.old_balance_Amount) }}</td>
            </tr>
            <tr>
                <td colspan="5" class="right-align"><strong>GRAND TOTAL</strong></td>
                <td>{{ "%.2f"|format(ledger.new_balance_Amount) }}</td>
            </tr>
        </tfoot>
    </table>

        <div class="footer">
      <div style="margin-top: 20px;">
    <div style="float: left;">
        <div>Cir. Manager</div>
        <div><strong>for MALLIGAI MAGAL</strong></div>
    </div>
    <div style="float: right; font-weight: bold;">
        (Rs. {{ '%.2f' | format(ledger.new_balance_Amount) }} ONLY /-)
    </div>
    <div style="clear: both;"></div>
</div>

    </div>
</div>
<br>
<br>
<br>
<div class="bill-box">
    
    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px;">
    <!-- Left: Title and Address -->
    <div style="text-align: left; width: 33%;">
        <div style="font-size: 18px; font-weight: bold;">MALLIGAI MAGAL</div>
        <div style="font-size: 11px;">
            New # 4, Old # 46, Taylors Estate 2nd Street,<br>
            Kodambakkam, Chennai - 600 024.<br>
            Phone : 044 - 2472 0565, 75501 83899
        </div>
    </div>

    <!-- Center: Logo -->
    <div style="width: 34%; text-align: center;">
        <img src="{{ url_for('static', filename='logo.jpg') }}" alt="Logo" style="height: 60px;">
        <div style="font-size: 14px; font-weight: bold;">CREDIT BILL</div>
        <div>No : <strong>{{ ledger.id }}</strong></div>
    </div>

    <!-- Right: Recipient Details -->
    <div style="text-align: right; width: 33%;">
        <div style="font-size: 15px;"><strong>Agent Name:</strong> {{ agent.agent_Name }}</div>
        <div style="font-size: 15px;"><strong>Location:</strong>{{ agent.area }}</div>
        <div style="margin-top: 10px; font-size: 15px;"><strong>Date:</strong> {{ ledger.credit_date }}</div>
    </div>
</div>
 


    <table class="bill-table">
        <thead>
        <tr>
            <th>S.No</th>
            <th>Particulars</th>
            <th>Rate</th>
            <th>Copies</th>
            <th>Discount</th>
            <th>Amount (Rs.)</th>
        </tr>
        </thead>
        <tbody>
        {% set items = [
            ('Malligai Magal', ledger.ret_count_MM, 40),
            ('Nalla Saappadu', ledger.ret_count_NS, 50),
            ('Valli Novel', ledger.ret_count_Valli, 40),
            ('Vaani Novel', ledger.ret_count_Vani, 40),
            ('Azhagi Novel', ledger.ret_count_Azhagi, 40),
            ('Arasi Novel', ledger.ret_count_Arasi, 40),
            ('Thriller Novel', ledger.ret_count_Thriller, 40)
        ] %}
        
        {% for idx in range(1, items|length + 1) %}
            {% set name, count, rate = items[idx - 1] %}
            {% set amt = (count or 0) * rate %}
            {% set discount = amt * 0.25 %}
            {% set final_amt = amt - discount %}
            <tr>
                <td>{{ idx }}</td>
                <td>{{ name }}</td>
                <td>Rs.{{ rate }}/-</td>
                <td>{{ count or 0 }}</td>
                <td>25%</td>
                <td>{{ "%.2f"|format(final_amt) }}</td>
            </tr>
        {% endfor %}
        </tbody>        
        <tfoot>
            <tr>
                <td colspan="5" class="right-align"><strong>Total Credit Amount</strong></td>
                <td>{{ "%.2f"|format(ledger.credit_Amount) }}</td>
            </tr>
        </tfoot>
    </table>

        <div class="footer">
      <div style="margin-top: 20px;">
    <div style="float: left;">
        <div>Cir. Manager</div>
        <div><strong>for MALLIGAI MAGAL</strong></div>
    </div>
    <div style="float: right; font-weight: bold;">
        (Rs. {{ '%.2f' | format(ledger.credit_Amount) }} ONLY /-)
    </div>
    <div style="clear: both;"></div>
</div>

    </div>
</div>
<br>
<br>
<br>

    <div class="receipt-top" style="align-items: center; width:70%;">
    
            <img src="{{ url_for('static', filename='logo.jpg') }}" alt="Logo" class="receipt-logo">

            <center><strong>
            MALLIGAI MAGAL <br>
            New # 4, Old # 46, Taylors Estate 2nd St., Kodambakkam, Chennai - 24.<br>
            Phone : 044-2472 0565, 7550183899, E-mail : malligaidesk@gmail.com<br></strong>
            </center>
        </div>
    </div>
<center><u>RECEIPT</u></center>
    <div class="receipt-row" >
        <div>No : <strong>{{ ledger.id }}</strong></div>
        <div>Date: <strong>{{ ledger.receipt_date }}</strong></div>
    </div>

    <div class="receipt-line">Received with thanks from Mr/Mrs/Ms. <strong>{{ agent.agent_Name }}</strong>
    the sum of Rupees <strong>Rs. {{ '%.2f' | format(ledger.receipt_Amount) }} ONLY /-</strong> by Cash / Cheque / UPI / Bank transfer
    </div>

    <div class="receipt-footer">
        <div class="receipt-box">
            (Rs. {{ '%.2f' | format(ledger.receipt_Amount) }} ONLY /-)
        </div>
        <div class="signature-block">
            for <strong>MALLIGAI MAGAL</strong><br>
            Manager
        </div>
    </div>


</body>
</html>
